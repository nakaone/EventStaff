<!DOCTYPE html><html lang="ja">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Script-Type" content="text/javascript">
<title>menu</title>
<link rel="stylesheet" href="css/default.css">
<style type="text/css">
    /* =========================================================
      ヘッダ
    ========================================================= */
    header {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 2rem;
      display: -webkit-flex;
      display: flex;
      -webkit-flex-direction: row;
      flex-direction: row;
      -webkit-justify-content: space-between;
      justify-content: space-between;
      margin-bottom: 1rem;
      background-color: #a0c238;
    }
    header .icon, .menuIcon {
      margin: 0.2rem;
      width: 1.6rem;
      height: 1.6rem;
    }
    header img {
      width: 100%;
      height: 100%;
    }
    header .title {
      margin: auto;
      width: calc(100% - 4rem);
      font-size: 1.2rem;
    }

    /* == メニュー =========================================== */
    header .menu img {
      margin: 0.3rem;
      max-width: 1.4rem;
      max-height: 1.4rem;
    }

    nav {
      z-index: 1;
      background-color: rgba(0,0,0,.5);
      position: absolute;
      top: 2rem;
      right: 0;
      width: 15rem;
      height: calc(100% - 2rem);
      display: none;
    }
    nav ol {
      padding: 0;
      margin: 0;
    }
    nav li {
      list-style-type: none;
      margin: 0.75rem;
      padding-right: 0.8rem;
      border: solid 3px #888;
      width: calc(15rem - 2.5rem - 6px);
      color: white;
      text-align: right;
      transition: .5s;
    }

    /* =========================================================
      メイン　※掲示板関係はBroad.cssで定義
    ========================================================= */
    #main {
      position: absolute;
      margin: 0px;
      top: 2.5rem;
      left: 0px;
      width: 100%;
      height: calc(100% - 2.5rem);
      border: none;
      /*border: solid 1px red;
      box-sizing: border-box;*/
    }
</style>
</head>
<body class="menu">
  <header>
    <div class="icon"><img src="img/stamp.png" /></div>
    <div class="title"></div>
    <div class="menuIcon"></div>
  </header>
  <nav></nav>
  <iframe id="main"></iframe>
</body>
<script type="text/javascript">
/** class Menu: メニュー表示、制御 */
class Menu {
  constructor(arg){
    console.log('Menu.constructor start.');
    this.dom = {};
    arg.title.innerText = 'メニュー初期化';
    this.dom.icon = arg.menuIcon;
    this.dom.nav = arg.nav;
    this.status = true; // メニューが開いている状態ならtrue
    this.closeMenu();

    this.menuObj = [
      /*
      {title:'お役立ち情報', scr:'information', flag:7168},
      */
      {title:'お知らせ', func:messageBoard, flag:3},
      {title:'受付業務', func:reception, flag:28},
      {title:'コーナー運営', func:cornerOperation, flag:32},
      {title:'参加受付', func:entry, flag:192},
      {title:'予約状況参照', func:referState, flag:768},
      {title:'お役立ち情報', func:information, flag:7168},
      {title:'参加者アンケート', func:enquete, flag:8192},
      {title:'システム設定', func:system, flag:49152}
    ];
    this.dom.ol = document.createElement('ol');
    this.menuObj.forEach(x => {
      // config.private.menuFlagsで指定されたメニューのみ追加
      if( (x.flag & config.private.menuFlags) > 0 ){
        const li = document.createElement('li');
        li.appendChild(document.createTextNode(x.title));
        //li.addEventListener('click',() => {this.closeMenu();changeScreen(x.scr,x.title);});
        li.addEventListener('click',() => {this.closeMenu();x.func();});
        this.dom.ol.appendChild(li);
      }
    });
    this.dom.nav.appendChild(this.dom.ol);
    console.log('Menu.constructor end.');
  }

  /** closeMenu: 開いているメニューを閉じる
   * @param {void} - なし
   * @returns {void} なし
   */
  closeMenu = () => {
    console.log('Menu.closeMenu start');
    if( this.status === false ){  // 既に閉じているなら何もしない
      return;
    }
    this.dom.icon.innerHTML = '<img src="img/menu1.svg" />';
    this.dom.icon.querySelector('img').onclick = this.openMenu;
    this.dom.nav.style.display = 'none';
    this.status = false;
    console.log('Menu.closeMenu end');
  }

  /** openMenu: 閉じているメニューを開く
   * @param {void} - なし
   * @returns {void} なし
   */
  openMenu = () => {
    console.log('Menu.openMenu start');
    if( this.status === true ){   // 既に開いているなら何もしない
      return;
    }
    this.dom.icon.innerHTML = '<img src="img/menu2.svg" />';
    this.dom.icon.querySelector('img').onclick = this.closeMenu;
    this.dom.nav.style.display = 'block';
    this.status = true;
    console.log('Menu.openMenu end');
  }
}

config.menu = new Menu(config.dom);
</script>
</html>
